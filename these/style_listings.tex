\lstloadlanguages{C}

% Warnings: 
% - Do not use other quantified variables than i, j and k
% - Do not add 
\lstdefinelanguage{pretty-ACSL}{%
  escapechar={},
  literate=
   {==}{{$==$}}2
   {==>}{{$\Rightarrow\ $}}1
   %{integer\ i}{{i$\,\in \mathbb{Z}\,$}}4
   %{integer\ j}{{j$\,\in \mathbb{Z}\,$}}4
   %{integer\ k}{{k$\,\in \mathbb{Z}\,$}}4
   %{integer\ m}{{m$\,\in \mathbb{Z}\,$}}4
   %{integer\ l}{{l$\,\in \mathbb{Z}\,$}}4
   %{\\sum(x,\ y,\ \\lambda\ integer\ k;\ t(k))}{{$\sum_{k=x}^y t_k$}}2
   %{\\product(x,\ y,\ \\lambda\ integer\ k;\ t(k))}{{$\prod_{k=x}^y t_k$}}2
   %{\\numof(x,\ y,\ \\lambda\ integer\ k;\ t(k))}{{$\#_{k=x}^y t_k$}}2
   %{\\min(x,\ y,\ \\lambda\ integer\ k;\ t(k))}{{$MIN_{k=x}^y t_k$}}2
   %{\\max(x,\ y,\ \\lambda\ integer\ k;\ t(k))}{{$MAX_{k=x}^y t_k$}}2
   %{\\lambda\ integer\ i;}{{$\lambda i . $}}2
   %{\\forall}{{$\forall$}}1
   %{\\exists}{{$\exists$}}1
   %{integer}{{$\mathbb{Z}$}}1
   {real}{{$\mathbb{R}$}}1
   {&&}{{$\wedge\ $}}1
   {||}{{$\vee\ $}}1
   {!=}{{$\neq$}}1
   {<}{{$<$}}1
   {<=}{{$\le$}}1
   {>}{{$>$}}1
   {>=}{{$\ge$}}1
   {<==>}{{$\Leftrightarrow\ $}}1,
  morekeywords={assert,assigns,assumes,axiom,axiomatic,behavior,behaviors,
    boolean,breaks,complete,continues,data,decreases,disjoint,ensures,
    exit_behavior,ghost,global,inductive,invariant,lemma,logic,loop,
    model,predicate,reads,requires,sizeof,strong,struct,terminates,
    type,union,variant,uchar,byte,typically,\\offset,\\result,\\old,\\at,\\valid,
    \\separated,\\nothing,Pre,Old,\\true,\\false,\\fresh,\\min,\\max,\\numof,
    \\sum,\\product,\\lambda,real,integer,postcondition,\\exists,\\forall},
  alsoletter={\\},
  keywordsprefix={\\},
  morecomment=[l]{//}
}
\lstnewenvironment{pretty-codeACSL}{\lstset{language=pretty-ACSL,stepnumber=0}}{\smallskip}

\lstdefinelanguage{ACSL}{%
  escapechar={},
  literate=,
  morekeywords={assert,assigns,assumes,axiom,axiomatic,behavior,behaviors,
    boolean,breaks,complete,continues,data,decreases,disjoint,ensures,
    exit_behavior,ghost,global,inductive,invariant,lemma,logic,loop,
    model,predicate,reads,requires,sizeof,strong,struct,terminates,postcond,precond,
    type,union,variant,uchar,byte,typically,\\offset,\\result,\\old,\\at,\\valid,
    \\separated,\\nothing,Pre,Old,\\true,\\false,\\fresh,\\min,\\max,\\numof,
    \\sum,\\product,\\lambda,real,integer,postcondition,\\exists,\\forall},
  alsoletter={\\},
  keywordsprefix={\\},
  morecomment=[l]{//}
}
\lstnewenvironment{codeACSL}{\lstset{language=ACSL,stepnumber=0}}{\smallskip}



\lstdefinestyle{pretty-c}{language={[ANSI]C},%
  alsolanguage=pretty-ACSL,%
  moredelim={*[l]{//}},%
  moredelim={*[s]{/*}{*/}},%
  moredelim={**[s]{/*@}{*/}},%
  deletecomment={[s]{/*}{*/}},
  moredelim={*[l]{//@}},%
}

\lstdefinestyle{c}{language={[ANSI]C},%
  alsolanguage=ACSL,%
  moredelim={*[l]{//}},%
  moredelim={*[s]{/*}{*/}},%
  moredelim={**[s]{/*@}{*/}},%
  deletecomment={[s]{/*}{*/}},
  moredelim={*[l]{//@}},%
}

\lstset{language=C,
  escapechar=§,
  style=c,
  basicstyle=\ttfamily\scriptsize,
  numberstyle=\tiny,
  numbers=left,
  stepnumber=1,
  numbersep=5pt,
  tab=\rightarrowfill,
  commentstyle=\color{green!40!black},
  keywordstyle={\bfseries\color{blue}},
  showstringspaces=false,
  stringstyle={\rmfamily\color{gray}},
  breaklines,
  breakatwhitespace,
  captionpos=b,
  float=tpb
}

%%%%%%%%%%%%%%%%% from Frama-C

\definecolor{lstnum}{gray}{0.4}
\definecolor{lstmodule}{rgb}{0.3,0.6,0.2}

\lstdefinestyle{framac-code-style}{%
basicstyle=\ifmmode\normalfont\mathtt\scriptstyle\else\normalfont\ttfamily\mdseries\small\fi,%
numberstyle=\rmfamily\tiny\color{lstnum},%
keywordstyle=[1]\sffamily\color{lstmodule},%
keywordstyle=[2]\sffamily\color{lstspecial},%
keywordstyle=[3]\sffamily\bfseries,%
identifierstyle=\rmfamily,%
stringstyle=\ttfamily\color{lstfg},%
commentstyle=\rmfamily\bfseries\color{lsttxt},%
}

\lstdefinelanguage{Ocaml}[Objective]{Caml}{%
style=framac-code-style,%
deletekeywords={when,module,struct,sig,begin,end},%
morekeywords=[2]{failwith,raise,when},%
morekeywords=[3]{module,struct,sig,begin,end},%
literate=%
{~}{${\scriptstyle\thicksim}$}1%
{<}{$<$}1%
{>}{$>$}1%
{->}{$\rightarrow$ }1%
{<-}{$\leftarrow$}1%
{:=}{$\leftarrow$}1%
{<=}{$\leq$}1%
{>=}{$\geq$}1%
{==}{$\equiv$}1%
{!=}{$\not\equiv$}1%
{<>}{$\neq$}1%
{'a}{$\alpha$}1%
{'b}{$\beta$}1%
{'c}{$\gamma$}1%
{µ}{`{}}1%
}
\lstdefinestyle{ocaml-basic}%
{language=Ocaml,basicstyle=\ifmmode\normalfont\mathtt\scriptstyle\else\normalfont\ttfamily\mdseries\small\fi}
\newcommand{\ocamlinput}[2][]{\lstinputlisting[style=ocaml-basic,#1]{#2}}
\lstnewenvironment{ocamlcode}[1][]{\lstset{style=ocaml-basic,#1}}{}
\newcommand{\ocamlinline}[1]{\lstinline[style=ocaml-basic]'#1'}
